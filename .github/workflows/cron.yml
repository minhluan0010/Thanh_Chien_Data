name: Thu Thap Du Lieu Thanh Chien

on:
  workflow_dispatch: # Cho phÃ©p cháº¡y thá»§ cÃ´ng
  schedule:
    # Cháº¡y vÃ o phÃºt 59 má»—i giá»
    # (VÃ­ dá»¥: 09:59, 10:59, 11:59...)
    - cron: '59 * * * *'

jobs:
  build:
    runs-on: ubuntu-latest # Cháº¡y trÃªn mÃ¡y chá»§ áº£o Ubuntu

    steps:
      # BÆ°á»›c 1: Láº¥y mÃ£ nguá»“n (code) cá»§a báº¡n tá»« repo vá»
      - name: Checkout repository
        uses: actions/checkout@v4

      # BÆ°á»›c 2: CÃ i Ä‘áº·t mÃ´i trÆ°á»ng Node.js (phiÃªn báº£n 18)
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18
          # cache: 'npm' # LÆ°u cache láº¡i cho nhanh

      # BÆ°á»›c 3: CÃ i Ä‘áº·t thÆ° viá»‡n (cháº¡y npm install)
      - name: Install dependencies
        run: npm install

      # BÆ°á»›c 4: Cháº¡y file script.js (Ä‘Ã¢y lÃ  lÃºc gá»i API)
      - name: Run script
        run: node script.js

      # BÆ°á»›c 5: Tá»° Äá»˜NG LÆ¯U THAY Äá»”I
      # (Náº¿u file history.json cÃ³ thay Ä‘á»•i, nÃ³ sáº½ tá»± Ä‘á»™ng commit)
      - name: Commit changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: 'ğŸ¤– Cáº­p nháº­t tá»± Ä‘á»™ng file history.json'
          file_pattern: 'history.json'
          commit_user_name: 'GitHub Action Bot'
          commit_user_email: 'action-bot@github.com'
          commit_author: 'GitHub Action Bot <action-bot@github.com>'
